function drawstamen(){stamens.length<maxstamen&&stamens.push(new Stamen),TYPE>7||3==drawstyle||6==feature?drawstamenshort():drawstamenlong(),stamens=stamens.filter(p=>!(p.LS>p.LSlimit&&nzb(.82)))}function drawstamenshort(){for(let p of stamens){if(p.LSlimit/2<p.LS){let lightness=220*noise(p.LS/10);stroke(color(p.hu,100,lightness,p.LS/70)),strokeWeight(bx/40);for(let i=0;i<5;i++)6==feature?line(p.maxpos.x,p.maxpos.y,p.maxpos.x+nzm(-2,2)**3*strad,p.maxpos.y+nzm(-2,2)**3*strad):line(p.maxpos.x,p.maxpos.y,p.maxpos.x+(noise(i+p.hu+p.LS/10)-.5)*strad,p.maxpos.y+(noise(i-p.hu+p.LS/15)-.5)*strad)}maxpos=p.pos.copy(),p.maxpos.add(p.vel.copy().mult(5e-4)),p.LS+=.2}}function drawstamenlong(){for(let p of stamens){if(p.LSlimit/2<p.LS){stroke(color(p.hu,100,80*noise(p.LS/9)+40,p.LS/50)),strokeWeight(bx/20);for(let i=0;i<10;i++)line(p.maxpos.x,p.maxpos.y,p.maxpos.x+(noise(p.hu+i+p.LS/50)-.5)*strad,p.maxpos.y+(noise(i+p.LS/20)-.5)*strad)}let maxpos=p.pos.copy(),vel=p.vel.copy(),max=min(p.LS,p.LSlimit);for(let i=.1;i<=max;i+=max/20){vel.add(p.acc),vel.setMag(max/6);let pos=maxpos.copy().add(vel);stroke(color(p.hu,100,2*i+50,min(i/p.LSlimit/4,.5))),strokeWeight(bx/5),line(maxpos.x,maxpos.y,pos.x,pos.y),maxpos=pos.copy()}p.maxpos=maxpos.copy(),p.LS+=.2,p.acc.add(0,(4==TYPE?2e-4:35e-6)*bx)}}class Stamen{constructor(){if(0==TYPE?this.LSlimit=random(strad/30,2*strad):this.LSlimit=random(strad,2*strad),6==TYPE){let center=petals[floor(random(petals.length-1))];this.pos=center.petalcenter,this.vel=this.pos.copy().sub(center.thome),this.LSlimit/=2}else this.pos=createVector(stamencenter.x+nzr(1)*strad*9,stamencenter.y+nzr(1)*strad*9),this.vel=this.pos.copy();this.acc=createVector(0,0),this.LS=random(10),this.hu=(petals[2].particles[1].color1+nzm(-20,20))%360,this.maxpos=this.pos.copy()}}